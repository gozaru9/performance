var authorityCtrl=angular.module("authorityCtrl",["AuthServices"]);authorityCtrl.controller("AuthorityCtrl",["$scope","Auth","Utility",function(e){e.initialize=function(){e.isCollapsed=!1,e.data={}},e.submit=function(){}}]);var loginCtrl=angular.module("loginCtrl",["AuthServices"]);loginCtrl.controller("LoginCtrl",["$scope","Auth","Utility",function(e,t){e.initialize=function(){e.data={mailAddress:"",password:"",remember:!1}},e.submit=function(){t.login(e.data)}}]);var organizationsCtrl=angular.module("organizationsCtrl",["OrganizationServices","ModalService"]);organizationsCtrl.controller("OrganizationsCtrl",["$scope","Organization","Utility","Modal",function(e,t,s,a){var i=t.getResource();e.organizationList=[],e.initialize=function(){i.get({},function(t){t.status?e.organizationList=t.itemList:s.errorSticky("データの取得に失敗しました")})},e.create=function(t){var a=new i({name:t});a.$save(function(t){e.categoryName="",t.status?(e.organizationList.push(t.item),s.success("登録しました")):s.errorSticky(t.messages)})},e.popupView=function(t,s){e.updateid=t,e.targetindex=s,e.modalParam={header:"組織名を変更します",initValue:e.organizationList[s].name},e.modalInstance=a.open(e,"partials/modal/updateSimpleModal.html")},e.update=function(t){var a=new i({_id:e.updateid,name:t});a.$save(function(a){a.status?(e.organizationList[e.targetindex].name=t,s.success("更新しました"),e.modalInstance.close()):s.errorSticky(a.messages)})},e.delete=function(t,a){i.remove({_id:t},function(t){t.status?(e.organizationList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);var postsCtrl=angular.module("postsCtrl",["PostTypeServices","ModalService"]);postsCtrl.controller("PostsCtrl",["$scope","PostsType","Utility","Modal",function(e,t,s,a){var i=t.getResource();e.postsList=[],e.initialize=function(){i.get({},function(t){t.status?e.postsList=t.itemList:s.errorSticky("データの取得に失敗しました")})},e.create=function(t,a){var r=new i({name:t,description:a});r.$save(function(t){e.postName="",e.description="",t.status?(e.postsList.push(t.item),s.success("登録しました")):s.errorSticky(t.messages)})},e.popupView=function(t,s){e.updateid=t,e.targetindex=s,e.modalParam={header:"役職名を変更します",initValue1:e.postsList[s].name,initValue2:e.postsList[s].description},e.modalInstance=a.open(e,"partials/modal/updateTwoItemModal.html")},e.update=function(){var t=new i({_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2});t.$save(function(t){t.status?(e.postsList[e.targetindex]=t.item,s.success("更新しました"),e.modalInstance.close()):s.errorSticky(t.messages)})},e.delete=function(t,a){i.remove({_id:t},function(t){t.status?(e.postsList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);var profilesCtrl=angular.module("profilesCtrl",["UesrServices","ModalService"]);profilesCtrl.controller("ProfilesCtrl",["$scope","User","Utility","Modal",function(e,t,s){e.initialize=function(){e.tabStatus={profile:!0},e.radarChartData=[],t.getResource("skill").get({},function(t){if(t.status)for(var a=t.items.skillList,i=t.items.skillList.length,r=0;i>r;r++){for(var o=[],n=[],l=a[r].skills.length,c=0;l>c;c++)o.push(a[r].skills[c].name),n.push(a[r].skills[c].numberOfYear);var u=[];u.push(n),e.radarChartData.push({label:o,data:u})}else s.errorSticky(t.message)})}}]),profilesCtrl.controller("ProfilesSkillsCtrl",["$scope","User","Utility","Modal",function(e,t,s){e.initialize=function(){e.tabStatus={skills:!0},e.skillList=[],t.getResource("skill").get({},function(t){t.status?e.skillList=t.items.skillList:s.errorSticky(t.message)})},e.isDisabled=function(t,s){e.skillList[t].skills[s].numberOfYear=0},e.submit=function(){var a=t.createSkillSubmitInfo(e.skillList),i=t.getResource("skill"),r=new i({skill:a.skillData,skillNameList:a.skillNameList});r.$save(function(e){e.status?s.success(e.message):s.errorSticky(e.message)})}}]),profilesCtrl.controller("ProfilesResumeCtrl",["$scope","User","Utility","Modal",function(e){e.initialize=function(){e.tabStatus={resume:!0}}}]),profilesCtrl.controller("ProfilesCertificatesCtrl",["$scope","User","Utility","Modal",function(e){e.initialize=function(){e.tabStatus={certificates:!0}}}]);var projectsCtrl=angular.module("projectsCtrl",["ProjectServices","ModalService","DatepickerServices"]);projectsCtrl.controller("ProjectsCtrl",["$scope","Project","Utility","Modal","Datepicker",function(e,t,s,a,i){var r=t.getResource();e.projectsList=[],e.data={name:"",description:"",begin:"",end:""},e.initialize=function(){i.init(e),r.get({},function(t){t.status?e.projectsList=t.itemList:s.errorSticky("データの取得に失敗しました")})},e.create=function(){var t=new r(e.data);t.$save(function(t){t.status?(e.data={},e.projectsList.push(t.item),s.success("登録しました")):s.errorSticky(t.messages)})},e.popupView=function(t,s){e.updateid=t,e.targetindex=s,e.modalParam={header:"プロジェクトを変更します",initValue1:e.projectsList[s].name,initValue2:e.projectsList[s].description},e.modalInstance=a.open(e,"partials/modal/updateTwoItemModal.html")},e.update=function(){var t=new r({_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2});t.$save(function(t){t.status?(e.projectsList[e.targetindex]=t.item,s.success("更新しました"),e.modalInstance.close()):s.errorSticky(t.messages)})},e.delete=function(t,a){r.remove({_id:t},function(t){t.status?(e.projectsList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);var ranksCtrl=angular.module("ranksCtrl",["RankServices","ModalService"]);ranksCtrl.controller("RanksCtrl",["$scope","Rank","Utility","Modal",function(e,t,s,a){var i=t.getResource();e.ranksList=[],e.initialize=function(){i.get({},function(t){t.status?e.ranksList=t.itemList:s.errorSticky("データの取得に失敗しました")})},e.create=function(){var t=new i({name:e.rankName,description:e.description});t.$save(function(t){e.rankName="",e.description="",t.status?(e.ranksList.push(t.item),s.success("登録しました")):s.errorSticky(t.messages)})},e.popupView=function(t,s){e.updateid=t,e.targetindex=s,e.modalParam={header:"ランクを変更します",initValue1:e.ranksList[s].name,initValue2:e.ranksList[s].description},e.modalInstance=a.open(e,"partials/modal/updateTwoItemModal.html")},e.update=function(){var t=new i({_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2});t.$save(function(t){t.status?(e.ranksList[e.targetindex]=t.item,s.success("更新しました"),e.modalInstance.close()):s.errorSticky(t.messages)})},e.delete=function(t,a){i.remove({_id:t},function(t){t.status?(e.ranksList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);var skillsCtrl=angular.module("skillsCtrl",["SkillServices","ModalService"]);skillsCtrl.controller("SkillCategoryCtrl",["$rootScope","$scope","SkillCategory","Utility","Modal",function(e,t,s,a,i){t.skillCategory=s,t.categoryList=[],t.initialize=function(){t.skillCategory.getResource().get({},function(s){s.status?(t.categoryList=s.itemList,e.$broadcast("categoryListBroadcast",s.itemList)):a.errorSticky("データの取得に失敗しました")})},t.create=function(e){var i=s.getResource(),r=new i({name:e});r.$save(function(e){t.categoryName="",e.status?(t.categoryList.push(e.item),a.success("登録しました")):a.errorSticky("登録に失敗しました")})},t.popupView=function(e,s){t.updateid=e,t.targetindex=s,t.modalParam={header:"カテゴリ名を変更します",initValue:t.categoryList[s].name},t.modalInstance=i.open(t,"partials/modal/updateSimpleModal.html")},t.update=function(e){var i=s.getResource(),r=new i({_id:t.updateid,name:e});r.$save(function(s){s.status?(t.categoryList[t.targetindex].name=e,a.success("更新しました"),t.modalInstance.close()):a.errorSticky(s.messages)})},t.delete=function(e,i){var r=s.getResource();r.remove({_id:e},function(e){e.status?(t.categoryList.splice(i,1),a.success("削除しました")):a.errorSticky("削除に失敗しました")})}}]),skillsCtrl.controller("SkillsCtrl",["$scope","Skill","Utility","Modal",function(e,t,s,a){e.skill=t,e.categoryList=[],e.selectCategory=null,e.$on("categoryListBroadcast",function(t,s){e.categoryList=s}),e.skillList=[],e.getSkill=function(){var a=t.getResource();a.get({_id:e.selectCategory},function(t){t.status?e.skillList=t.itemList:s.errorSticky("取得に失敗しました")})},e.create=function(a){var i=t.getResource(),r=new i({category:e.selectCategory,name:a});r.$save(function(t){e.skillName="",t.status?e.skillList.push(t.item):s.errorSticky(t.messages)})},e.popupView=function(t,s){e.updateid=t,e.targetindex=s,e.modalParam={header:"スキル名を変更します",initValue:e.skillList[s].name},e.modalInstance=a.open(e,"partials/modal/updateSimpleModal.html")},e.update=function(a){var i=t.getResource(),r=new i({_id:e.updateid,name:a});r.$save(function(t){t.status?(e.skillList[e.targetindex].name=a,s.success("更新しました"),e.modalInstance.close()):s.errorSticky(t.messages)})},e.delete=function(a,i){var r=t.getResource();r.remove({_id:a},function(t){t.status?(e.skillList.splice(i,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);var tagsCtrl=angular.module("tagsCtrl",["TagServices","ModalService"]);tagsCtrl.controller("TagsCtrl",["$scope","Tag","Utility","Modal",function(e,t,s,a){var i=t.getResource();e.tagsList=[],e.initialize=function(){i.get({},function(t){t.status?e.tagsList=t.itemList:s.errorSticky("データの取得に失敗しました")})},e.create=function(t,a){var r=new i({name:t,description:a,color:e.color});r.$save(function(t){e.postName="",e.description="",t.status?(e.tagsList.push(t.item),s.success("登録しました")):s.errorSticky(t.messages)})},e.popupView=function(t,s){e.updateid=t,e.targetindex=s,e.modalParam={header:"タグを変更します",initValue1:e.tagsList[s].name,initValue2:e.tagsList[s].description,updateColor:e.tagsList[s].color},e.modalInstance=a.open(e,"partials/modal/updateColorItemModal.html")},e.update=function(){var t={_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2,color:e.modalParam.updateColor},a=new i(t);a.$save(function(t){e.tagName="",e.description="",t.status?(e.tagsList[e.targetindex]=t.item,s.success("更新しました"),e.modalInstance.close()):s.errorSticky(t.message)})},e.delete=function(t,a){i.remove({_id:t},function(t){t.status?(e.tagsList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);var teamsCtrl=angular.module("teamsCtrl",["TeamServices","UesrServices","ModalService"]);teamsCtrl.controller("TeamsCtrl",["$scope","$routeParams","Team","User","Skill","Utility","Modal",function(e,t,s,a,i,r,o){function n(t){t.status?e.userList=t.itemList:r.errorSticky(t.mesage)}function l(t){if(t.status){t.item.project={_id:t.item.project,name:c(t.item.project)};for(var s=[],a=0;a<e.selectedMemberList.length;a++)s.push({_id:e.selectedMemberList[a]._id,firstName:e.selectedMemberList[a].firstName,lastName:e.selectedMemberList[a].lastName});t.item.member=s,e.isCreate?e.teamsList.push(t.item):(e.teamsList[m]=t.item,e.isCreate=!0),e.data={},e.keywords=null,e.userList=[],e.selectedMemberList=[],r.success(t.messages)}else r.errorSticky(t.messages)}function c(t){for(var s=0;s<e.projectList.length;s++)if(t===e.projectList[s]._id)return e.projectList[s].name}var u=s.getResource(),d="",m=null,p=null,g=[];e.data={},e.isCollapsed=!1,e.isCreate=!0,e.isOpenList=!1,e.radarChartData=[],e.initialize=function(){e.selectedMemberList=[],u.get({},function(s){s.status?(e.teamsList=s.itemLists.teams,e.projectList=s.itemLists.projects,void 0!==t.id&&(e.data.project=t.id)):r.errorSticky(s.messages)}),i.getResource("belong").get({},function(e){e.status?p=e.items:r.errorSticky(e.messages)})},e.search=function(){""===e.keywords?a.getResource().get({},n):a.getResource("keyword").get({q:e.keywords},n)},e.addMember=function(t){for(var s=e.userList[t],i={_id:s._id,firstName:s.firstName,lastName:s.lastName},r=e.selectedMemberList.length,o=!1,n=0;r>n;n++)if(e.selectedMemberList[n]._id===i._id){o=!0;break}o||(e.selectedMemberList.push(i),g.push(s.skills)),e.selectedNumber=e.selectedMemberList.length,e.isSelected=0!==e.selectedMemberList.length,e.radarChartData=a.createRadarChartData(p,g)},e.removeMember=function(t){e.selectedMemberList.splice(t,1),g.splice(t,1);var s=e.selectedMemberList.length;e.isSelected=0!==s,e.selectedNumber=s,e.isSelected&&(e.radarChartData=a.createRadarChartData(p,g))},e.popupView=function(t,s){e.modalParam=e.userList[s],e.modalInstance=o.open(e,"partials/modal/viewUserModal.html")},e.create=function(){var t=e.data;t.member=[];for(var s=0;s<e.selectedMemberList.length;s++)t.member.push(e.selectedMemberList[s]._id);var a=new u(t);a.$save(l)},e.modeUpdate=function(t){var s=e.teamsList[t];e.data.project=s.project._id,e.data.name=s.name,e.data.description=s.description,e.isSelected=0!==s.member.length,e.selectedMemberList=s.member,e.isCreate=!1,d=e.teamsList[t]._id,m=t;var i=s.member.length;if(0!==i){g=[];for(var r=0;i>r;r++)g.push(s.member[r].skills);e.radarChartData=a.createRadarChartData(p,g)}},e.update=function(){var t=e.data;t._id=d,t.member=[];for(var s=0;s<e.selectedMemberList.length;s++)t.member.push(e.selectedMemberList[s]._id);var a=new u(t);a.$save(l)},e.delete=function(t,s){u.remove({_id:t},function(t){t.status?(e.teamsList.splice(s,1),r.success("削除しました")):r.errorSticky(t.messages)})}}]);var usersCtrl=angular.module("usersCtrl",["UesrServices","OrganizationServices","PostTypeServices","RankServices","DatepickerServices"]);usersCtrl.controller("UsersCtrl",["$scope","$routeParams","$location","User","SharedUserModel","Organization","PostsType","Rank","Utility","Datepicker",function(e,t,s,a,i,r,o,n,l,c){function u(t){e.data.firstName=t.firstName,e.data.lastName=t.lastName,e.data.firstNameKana=t.firstNameKana,e.data.lastNameKana=t.lastNameKana,e.data.mailAddress=t.mailAddress;var s=t.birth.split("-");e.data.birthYear=s[0],e.data.birthMonth=s[1],e.data.birthDay=s[2],e.data.sex=String(t.sex);var a=t.telNo.split("-");e.data.telFront=a[0],e.data.telCenter=a[1],e.data.telBack=a[2];var i=t.zip.split("-");e.data.zipFront=i[0],e.data.zipBack=i[1],e.data.prefectures=t.prefectures,e.data.city=t.city,e.data.address=t.address,e.data.employeeNumber=t.employeeNumber,e.data.employeeType=String(t.employeeType),e.data.organizations=t.organizations[0]._id,e.data.posts=t.posts[0]._id,e.data.ranks=t.ranks._id,e.data.entryDate=new Date(t.entryDate)}e.data={firstName:"",lastName:"",firstNameKana:"",lastNameKana:"",mailAddress:"",password:"",passwordConfirm:"",birthYear:"",birthMonth:"",birthDay:"",sex:"",telFront:"",telCenter:"",telBack:"",zipFront:"",zipBack:"",prefectures:"",city:"",address:"",employeeNumber:"",employeeType:"",organizations:"",posts:"",ranks:"",entryDate:new Date},e.subtext="",e.initialize=function(){var s=l.subtractYear(l.today(),70).format("YYYY"),i=l.today("YYYY");e.minDate=new Date(l.subtractYear(l.today(),70).format("YYYY-MM-DD")),c.init(e),e.yearList=l.createYearList(s,i),e.monthList=l.createMonthList(),e.dayList=l.createDayList(l.dayInMonth()),e.prefecturesList=a.getPrefectures(),r.getResource().get({},function(t){t.status&&(e.organizationList=t.itemList)}),o.getResource().get({},function(t){t.status&&(e.postList=t.itemList)}),n.getResource().get({},function(t){t.status&&(e.rankList=t.itemList)}),e.isCreate=!0,e.subtext="新規ユーザーを作成します",void 0!==t.id&&(e.isCreate=!1,e.subtext="ユーザー情報を更新します",a.getResource().get({id:t.id},function(e){e.status?u(e.item):l.errorSticky(e.message)}))};var d=function(t){e.data.age=""===t?"":l.diffYear(l.today(),t)};e.createOptions=function(){var t=a.createBirth(e.data.birthYear,e.data.birthMonth,e.data.birthDay);if(""!==e.data.birthYear&&""!==e.data.birthMonth){var s=e.data.birthYear+"-"+e.data.birthMonth+"-01";e.dayList=l.createDayList(l.dayInMonth(s))}d(t)},e.getAge=function(){var t=a.createBirth(e.data.birthYear,e.data.birthMonth,e.data.birthDay);d(t)},e.submit=function(){var r="登録しました";e.isCreate||(r="更新しました",e.data.id=t.id);var o=a.getResource(),n=new o(e.data);n.$save(function(t){t.status?(e.data={},l.success(r),i._id=t.item._id,s.path("/member/mgt/skill")):l.errorSticky(t.message)})},e.remove=function(){console.log("remove")}}]),usersCtrl.controller("UsersSetSkillCtrl",["$scope","$location","User","SharedUserModel","Skill","Utility",function(e,t,s,a,i,r){e.announce=!0,e.initialize=function(){e.tabStatus={skills:!0},e.skillList=[],s.getResource("skill").get({id:a._id},function(t){t.status?e.skillList=t.items.skillList:r.errorSticky(t.message)})},e.isDisabled=function(t,s){e.skillList[t].skills[s].numberOfYear=0},e.submit=function(){var t=s.createSkillSubmitInfo(e.skillList),i=s.getResource("skill"),o=new i({_id:a._id,skill:t.skillData,skillNameList:t.skillNameList});o.$save(function(e){e.status?r.success(e.message):r.errorSticky(e.message)})},e.finish=function(){t.path("/member/mgt")}}]);var usersListCtrl=angular.module("usersListCtrl",["UesrServices","ModalService"]);usersListCtrl.controller("UsersListCtrl",["$scope","User","Utility","Modal",function(e,t,s,a){function i(t){t.status?e.userList=t.itemList:s.errorSticky(t.mesage)}var r=t.getResource();e.sort="",e.initialize=function(){e.userList=[],e.keywords="",t.getResource().get({},i)},e.search=function(){""===e.keywords?t.getResource().get({},i):t.getResource("keyword").get({q:e.keywords},i)},e.popupView=function(t,s){e.modalParam=e.userList[s],e.modalInstance=a.open(e,"partials/modal/viewUserModal.html")},e.delete=function(t,a){r.remove({_id:t},function(t){t.status?(e.userList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);