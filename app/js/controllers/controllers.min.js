var loginCtrl=angular.module("loginCtrl",["AuthServices"]);loginCtrl.controller("LoginCtrl",["$scope","Auth","Utility",function(e,t){e.data={mailAddress:"",password:"",remember:!1},e.submit=function(){t.login(e.data)}}]);var organizationsCtrl=angular.module("organizationsCtrl",["OrganizationServices","ModalService"]);organizationsCtrl.controller("OrganizationsCtrl",["$scope","Organization","Utility","Modal",function(e,t,a,s){var i=t.getResource();e.organizationList=[],e.getAll=function(){i.get({},function(t){t.status?e.organizationList=t.itemList:a.errorSticky("データの取得に失敗しました")})},e.create=function(t){var s=new i({name:t});s.$save(function(t){e.categoryName="",t.status?(e.organizationList.push(t.item),a.success("登録しました")):a.errorSticky(t.messages)})},e.popupView=function(t,a){e.updateid=t,e.targetindex=a,e.modalParam={header:"組織名を変更します",initValue:e.organizationList[a].name},e.modalInstance=s.open(e,"partials/modal/updateSimpleModal.html")},e.update=function(t){var s=new i({_id:e.updateid,name:t});s.$save(function(s){s.status?(e.organizationList[e.targetindex].name=t,a.success("更新しました"),e.modalInstance.close()):a.errorSticky(s.messages)})},e.delete=function(t,s){i.remove({_id:t},function(t){t.status?(e.organizationList.splice(s,1),a.success("削除しました")):a.errorSticky("削除に失敗しました")})}}]);var postsCtrl=angular.module("postsCtrl",["PostTypeServices","ModalService"]);postsCtrl.controller("PostsCtrl",["$scope","PostsType","Utility","Modal",function(e,t,a,s){var i=t.getResource();e.postsList=[],e.getAll=function(){i.get({},function(t){t.status?e.postsList=t.itemList:a.errorSticky("データの取得に失敗しました")})},e.create=function(t,s){var r=new i({name:t,description:s});r.$save(function(t){e.postName="",e.description="",t.status?(e.postsList.push(t.item),a.success("登録しました")):a.errorSticky(t.messages)})},e.popupView=function(t,a){e.updateid=t,e.targetindex=a,e.modalParam={header:"役職名を変更します",initValue1:e.postsList[a].name,initValue2:e.postsList[a].description},e.modalInstance=s.open(e,"partials/modal/updateTwoItemModal.html")},e.update=function(){var t=new i({_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2});t.$save(function(t){t.status?(e.postsList[e.targetindex]=t.item,a.success("更新しました"),e.modalInstance.close()):a.errorSticky(t.messages)})},e.delete=function(t,s){i.remove({_id:t},function(t){t.status?(e.postsList.splice(s,1),a.success("削除しました")):a.errorSticky("削除に失敗しました")})}}]);var profilesCtrl=angular.module("profilesCtrl",["UesrServices","ModalService"]);profilesCtrl.controller("ProfilesCtrl",["$scope","User","Utility","Modal",function(e,t,a,s){var i=t.getResource();e.profilesList=[],e.initialize=function(){i.get({},function(t){t.status?e.profilesList=t.itemList:a.errorSticky("データの取得に失敗しました")})},e.create=function(t,s){var r=new i({name:t,description:s});r.$save(function(t){e.teamName="",e.description="",t.status?(e.profilesList.push(t.item),a.success("登録しました")):a.errorSticky(t.messages)})},e.popupView=function(t,a){e.updateid=t,e.targetindex=a,e.modalParam={header:"プロジェクトを変更します",initValue1:e.profilesList[a].name,initValue2:e.profilesList[a].description},e.modalInstance=s.open(e,"partials/modal/updateTwoItemModal.html")},e.update=function(){var t=new i({_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2});t.$save(function(t){t.status?(e.profilesList[e.targetindex]=t.item,a.success("更新しました"),e.modalInstance.close()):a.errorSticky(t.messages)})},e.delete=function(t,s){i.remove({_id:t},function(t){t.status?(e.profilesList.splice(s,1),a.success("削除しました")):a.errorSticky("削除に失敗しました")})}}]);var projectsCtrl=angular.module("projectsCtrl",["ProjectServices","ModalService","DatepickerServices"]);projectsCtrl.controller("ProjectsCtrl",["$scope","Project","Utility","Modal","Datepicker",function(e,t,a,s,i){var r=t.getResource();e.projectsList=[],e.data={name:"",description:"",begin:"",end:""},e.initialize=function(){i.init(e),r.get({},function(t){t.status?e.projectsList=t.itemList:a.errorSticky("データの取得に失敗しました")})},e.create=function(){var t=new r(e.data);t.$save(function(t){t.status?(e.data={},e.projectsList.push(t.item),a.success("登録しました")):a.errorSticky(t.messages)})},e.popupView=function(t,a){e.updateid=t,e.targetindex=a,e.modalParam={header:"プロジェクトを変更します",initValue1:e.projectsList[a].name,initValue2:e.projectsList[a].description},e.modalInstance=s.open(e,"partials/modal/updateTwoItemModal.html")},e.update=function(){var t=new r({_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2});t.$save(function(t){t.status?(e.projectsList[e.targetindex]=t.item,a.success("更新しました"),e.modalInstance.close()):a.errorSticky(t.messages)})},e.delete=function(t,s){r.remove({_id:t},function(t){t.status?(e.projectsList.splice(s,1),a.success("削除しました")):a.errorSticky("削除に失敗しました")})}}]);var ranksCtrl=angular.module("ranksCtrl",["RankServices","ModalService"]);ranksCtrl.controller("RanksCtrl",["$scope","Rank","Utility","Modal",function(e,t,a,s){var i=t.getResource();e.ranksList=[],e.getAll=function(){i.get({},function(t){t.status?e.ranksList=t.itemList:a.errorSticky("データの取得に失敗しました")})},e.create=function(){var t=new i({name:e.rankName,description:e.description});t.$save(function(t){e.rankName="",e.description="",t.status?(e.ranksList.push(t.item),a.success("登録しました")):a.errorSticky(t.messages)})},e.popupView=function(t,a){e.updateid=t,e.targetindex=a,e.modalParam={header:"ランクを変更します",initValue1:e.ranksList[a].name,initValue2:e.ranksList[a].description},e.modalInstance=s.open(e,"partials/modal/updateTwoItemModal.html")},e.update=function(){var t=new i({_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2});t.$save(function(t){t.status?(e.ranksList[e.targetindex]=t.item,a.success("更新しました"),e.modalInstance.close()):a.errorSticky(t.messages)})},e.delete=function(t,s){i.remove({_id:t},function(t){t.status?(e.ranksList.splice(s,1),a.success("削除しました")):a.errorSticky("削除に失敗しました")})}}]);var skillsCtrl=angular.module("skillsCtrl",["SkillServices","ModalService"]);skillsCtrl.controller("SkillCategoryCtrl",["$rootScope","$scope","SkillCategory","Utility","Modal",function(e,t,a,s,i){t.skillCategory=a,t.categoryList=[],t.getAll=function(){t.skillCategory.get({},function(a){a.status?(t.categoryList=a.itemList,e.$broadcast("categoryListBroadcast",a.itemList)):s.errorSticky("データの取得に失敗しました")})},t.create=function(e){var i=new a({name:e});i.$save(function(e){t.categoryName="",e.status?(t.categoryList.push(e.item),s.success("登録しました")):s.errorSticky("登録に失敗しました")})},t.popupView=function(e,a){t.updateid=e,t.targetindex=a,t.modalParam={header:"カテゴリ名を変更します",initValue:t.categoryList[a].name},t.modalInstance=i.open(t,"partials/modal/updateSimpleModal.html")},t.update=function(e){var i=new a({_id:t.updateid,name:e});i.$save(function(a){a.status?(t.categoryList[t.targetindex].name=e,s.success("更新しました"),t.modalInstance.close()):s.errorSticky(a.messages)})},t.delete=function(e,a){t.skillCategory.remove({_id:e},function(e){e.status?(t.categoryList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]),skillsCtrl.controller("SkillsCtrl",["$scope","Skill","Utility","Modal",function(e,t,a,s){e.skill=t,e.categoryList=[],e.selectCategory=null,e.$on("categoryListBroadcast",function(t,a){e.categoryList=a}),e.skillList=[],e.getSkill=function(){e.skill.get({_id:e.selectCategory},function(t){t.status?e.skillList=t.itemList:a.errorSticky("取得に失敗しました")})},e.create=function(s){var i=new t({category:e.selectCategory,name:s});i.$save(function(t){e.skillName="",t.status?e.skillList.push(t.item):a.errorSticky(t.messages)})},e.popupView=function(t,a){e.updateid=t,e.targetindex=a,e.modalParam={header:"スキル名を変更します",initValue:e.skillList[a].name},e.modalInstance=s.open(e,"partials/modal/updateSimpleModal.html")},e.update=function(s){var i=new t({_id:e.updateid,name:s});i.$save(function(t){t.status?(e.skillList[e.targetindex].name=s,a.success("更新しました"),e.modalInstance.close()):a.errorSticky(t.messages)})},e.delete=function(t,s){e.skill.remove({_id:t},function(t){t.status?(e.skillList.splice(s,1),a.success("削除しました")):a.errorSticky("削除に失敗しました")})}}]);var tagsCtrl=angular.module("tagsCtrl",["TagServices","ModalService"]);tagsCtrl.controller("TagsCtrl",["$scope","Tag","Utility","Modal",function(e,t,a,s){var i=t.getResource();e.tagsList=[],e.getAll=function(){i.get({},function(t){t.status?e.tagsList=t.itemList:a.errorSticky("データの取得に失敗しました")})},e.create=function(t,s){var r=new i({name:t,description:s,color:e.color});r.$save(function(t){e.postName="",e.description="",t.status?(e.tagsList.push(t.item),a.success("登録しました")):a.errorSticky(t.messages)})},e.popupView=function(t,a){e.updateid=t,e.targetindex=a,e.modalParam={header:"タグを変更します",initValue1:e.tagsList[a].name,initValue2:e.tagsList[a].description,updateColor:e.tagsList[a].color},e.modalInstance=s.open(e,"partials/modal/updateColorItemModal.html")},e.update=function(){var t={_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2,color:e.modalParam.updateColor},s=new i(t);s.$save(function(t){e.tagName="",e.description="",t.status?(e.tagsList[e.targetindex]=t.item,a.success("更新しました"),e.modalInstance.close()):a.errorSticky(t.message)})},e.delete=function(t,s){i.remove({_id:t},function(t){t.status?(e.tagsList.splice(s,1),a.success("削除しました")):a.errorSticky("削除に失敗しました")})}}]);var teamsCtrl=angular.module("teamsCtrl",["TeamServices","UesrServices","ModalService"]);teamsCtrl.controller("TeamsCtrl",["$scope","$routeParams","Team","User","Utility","Modal",function(e,t,a,s,i,r){function o(t){t.status?e.userList=t.itemList:i.errorSticky(t.mesage)}function n(t){if(t.status){t.item.project={_id:t.item.project,name:c(t.item.project)};for(var a=[],s=0;s<e.selectedMemberList.length;s++)a.push({_id:e.selectedMemberList[s]._id,firstName:e.selectedMemberList[s].firstName,lastName:e.selectedMemberList[s].lastName});t.item.member=a,e.isCreate?e.teamsList.push(t.item):(e.teamsList[u]=t.item,e.isCreate=!0),e.data={},e.keywords=null,e.userList=[],e.selectedMemberList=[],i.success(t.messages)}else i.errorSticky(t.messages)}function c(t){for(var a=0;a<e.projectList.length;a++)if(t===e.projectList[a]._id)return e.projectList[a].name}var l=a.getResource(),d="",u=null;e.data={},e.isCollapsed=!1,e.isCreate=!0,e.isOpenList=!1,e.initialize=function(){e.selectedMemberList=[],l.get({},function(a){a.status?(e.teamsList=a.itemLists.teams,e.projectList=a.itemLists.projects,void 0!==t.id&&(e.data.project=t.id)):i.errorSticky(a.messages)})},e.search=function(){""===e.keywords?s.getResource().get({},o):s.getResource("keyword").get({q:e.keywords},o)},e.addMember=function(t){for(var a=e.userList[t],s={_id:a._id,firstName:a.firstName,lastName:a.lastName},i=e.selectedMemberList.length,r=!1,o=0;i>o;o++)if(e.selectedMemberList[o]._id===s._id){r=!0;break}r||e.selectedMemberList.push(s),e.selectedNumber=e.selectedMemberList.length,e.isSelected=0!==e.selectedMemberList.length},e.removeMember=function(t){e.selectedMemberList.splice(t,1);var a=e.selectedMemberList.length;e.isSelected=0!==a,e.selectedNumber=a},e.popupView=function(t,a){e.modalParam=e.userList[a],e.modalInstance=r.open(e,"partials/modal/viewUserModal.html")},e.create=function(){var t=e.data;t.member=[];for(var a=0;a<e.selectedMemberList.length;a++)t.member.push(e.selectedMemberList[a]._id);var s=new l(t);s.$save(n)},e.modeUpdate=function(t){var a=e.teamsList[t];e.data.project=a.project._id,e.data.name=a.name,e.data.description=a.description,e.isSelected=0!==a.member.length,e.selectedMemberList=a.member,e.isCreate=!1,d=e.teamsList[t]._id,u=t},e.update=function(){var t=e.data;t._id=d,t.member=[];for(var a=0;a<e.selectedMemberList.length;a++)t.member.push(e.selectedMemberList[a]._id);var s=new l(t);s.$save(n)},e.delete=function(t,a){l.remove({_id:t},function(t){t.status?(e.teamsList.splice(a,1),i.success("削除しました")):i.errorSticky(t.messages)})}}]);var usersCtrl=angular.module("usersCtrl",["UesrServices","OrganizationServices","PostTypeServices","RankServices","DatepickerServices"]);usersCtrl.controller("UsersCtrl",["$scope","$routeParams","User","Organization","PostsType","Rank","Utility","Datepicker",function(e,t,a,s,i,r,o,n){function c(t){e.data.firstName=t.firstName,e.data.lastName=t.lastName,e.data.firstNameKana=t.firstNameKana,e.data.lastNameKana=t.lastNameKana,e.data.mailAddress=t.mailAddress;var a=t.birth.split("-");e.data.birthYear=a[0],e.data.birthMonth=a[1],e.data.birthDay=a[2],e.data.sex=String(t.sex);var s=t.telNo.split("-");e.data.telFront=s[0],e.data.telCenter=s[1],e.data.telBack=s[2];var i=t.zip.split("-");e.data.zipFront=i[0],e.data.zipBack=i[1],e.data.prefectures=t.prefectures,e.data.city=t.city,e.data.address=t.address,e.data.employeeNumber=t.employeeNumber,e.data.employeeType=String(t.employeeType),e.data.organizations=t.organizations[0]._id,e.data.posts=t.posts[0]._id,e.data.ranks=t.ranks._id,e.data.entryDate=new Date(t.entryDate)}e.data={firstName:"",lastName:"",firstNameKana:"",lastNameKana:"",mailAddress:"",password:"",passwordConfirm:"",birthYear:"",birthMonth:"",birthDay:"",sex:"",telFront:"",telCenter:"",telBack:"",zipFront:"",zipBack:"",prefectures:"",city:"",address:"",employeeNumber:"",employeeType:"",organizations:"",posts:"",ranks:"",entryDate:new Date},e.initialize=function(){n.init(e);var l=o.subtractYear(o.today(),70).format("YYYY"),d=o.today("YYYY");e.yearList=o.createYearList(l,d),e.monthList=o.createMonthList(),e.dayList=o.createDayList(o.dayInMonth()),e.prefecturesList=a.getPrefectures(),s.getResource().get({},function(t){t.status&&(e.organizationList=t.itemList)}),i.getResource().get({},function(t){t.status&&(e.postList=t.itemList)}),r.getResource().get({},function(t){t.status&&(e.rankList=t.itemList)}),e.isCreate=!0,void 0!==t.id&&(e.isCreate=!1,a.getResource().get({id:t.id},function(e){e.status?c(e.item):o.errorSticky(e.message)}))};var l=function(t){e.data.age=""===t?"":o.diffYear(o.today(),t)};e.createOptions=function(){var t=a.createBirth(e.data.birthYear,e.data.birthMonth,e.data.birthDay);if(""!==e.data.birthYear&&""!==e.data.birthMonth){var s=e.data.birthYear+"-"+e.data.birthMonth+"-01";e.dayList=o.createDayList(o.dayInMonth(s))}l(t)},e.getAge=function(){var t=a.createBirth(e.data.birthYear,e.data.birthMonth,e.data.birthDay);l(t)},e.submit=function(){var s="登録しました";e.isCreate||(s="更新しました",e.data.id=t.id);var i=a.getResource(),r=new i(e.data);r.$save(function(t){t.status?(e.data={},o.success(s)):o.errorSticky(t.message)})},e.remove=function(){console.log("remove")}}]);var usersListCtrl=angular.module("usersListCtrl",["UesrServices","ModalService"]);usersListCtrl.controller("UsersListCtrl",["$scope","User","Utility","Modal",function(e,t,a,s){function i(t){t.status?e.userList=t.itemList:a.errorSticky(t.mesage)}var r=t.getResource();e.sort="",e.initialize=function(){e.userList=[],e.keywords="",t.getResource().get({},i)},e.search=function(){""===e.keywords?t.getResource().get({},i):t.getResource("keyword").get({q:e.keywords},i)},e.popupView=function(t,a){e.modalParam=e.userList[a],e.modalInstance=s.open(e,"partials/modal/viewUserModal.html")},e.delete=function(t,s){r.remove({_id:t},function(t){t.status?(e.userList.splice(s,1),a.success("削除しました")):a.errorSticky("削除に失敗しました")})}}]);