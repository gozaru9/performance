var authorityCtrl=angular.module("authorityCtrl",["AuthServices"]);authorityCtrl.controller("AuthorityCtrl",["$scope","Auth","Utility",function(e){e.initialize=function(){e.isCollapsed=!1,e.data={}},e.submit=function(){}}]);var loginCtrl=angular.module("loginCtrl",["AuthServices"]);loginCtrl.controller("LoginCtrl",["$scope","Auth","Utility",function(e,t){e.initialize=function(){e.data={mailAddress:"",password:"",remember:!1}},e.submit=function(){t.login(e.data)}}]);var organizationsCtrl=angular.module("organizationsCtrl",["OrganizationServices","ModalService"]);organizationsCtrl.controller("OrganizationsCtrl",["$scope","Organization","Utility","Modal",function(e,t,s,a){var i=t.getResource();e.organizationList=[],e.getAll=function(){i.get({},function(t){t.status?e.organizationList=t.itemList:s.errorSticky("データの取得に失敗しました")})},e.create=function(t){var a=new i({name:t});a.$save(function(t){e.categoryName="",t.status?(e.organizationList.push(t.item),s.success("登録しました")):s.errorSticky(t.messages)})},e.popupView=function(t,s){e.updateid=t,e.targetindex=s,e.modalParam={header:"組織名を変更します",initValue:e.organizationList[s].name},e.modalInstance=a.open(e,"partials/modal/updateSimpleModal.html")},e.update=function(t){var a=new i({_id:e.updateid,name:t});a.$save(function(a){a.status?(e.organizationList[e.targetindex].name=t,s.success("更新しました"),e.modalInstance.close()):s.errorSticky(a.messages)})},e.delete=function(t,a){i.remove({_id:t},function(t){t.status?(e.organizationList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);var postsCtrl=angular.module("postsCtrl",["PostTypeServices","ModalService"]);postsCtrl.controller("PostsCtrl",["$scope","PostsType","Utility","Modal",function(e,t,s,a){var i=t.getResource();e.postsList=[],e.getAll=function(){i.get({},function(t){t.status?e.postsList=t.itemList:s.errorSticky("データの取得に失敗しました")})},e.create=function(t,a){var r=new i({name:t,description:a});r.$save(function(t){e.postName="",e.description="",t.status?(e.postsList.push(t.item),s.success("登録しました")):s.errorSticky(t.messages)})},e.popupView=function(t,s){e.updateid=t,e.targetindex=s,e.modalParam={header:"役職名を変更します",initValue1:e.postsList[s].name,initValue2:e.postsList[s].description},e.modalInstance=a.open(e,"partials/modal/updateTwoItemModal.html")},e.update=function(){var t=new i({_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2});t.$save(function(t){t.status?(e.postsList[e.targetindex]=t.item,s.success("更新しました"),e.modalInstance.close()):s.errorSticky(t.messages)})},e.delete=function(t,a){i.remove({_id:t},function(t){t.status?(e.postsList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);var profilesCtrl=angular.module("profilesCtrl",["UesrServices","ModalService"]);profilesCtrl.controller("ProfilesCtrl",["$scope","User","Utility","Modal",function(e){e.initialize=function(){e.tabStatus={profile:!0}}}]),profilesCtrl.controller("ProfilesSkillsCtrl",["$scope","User","Utility","Modal",function(e,t,s){e.initialize=function(){e.tabStatus={skills:!0},e.skillList=[],t.getResource("skill").get({},function(t){t.status?(console.log(t.items.skillList),e.skillList=t.items.skillList):s.errorSticky(t.message)})},e.isDisabled=function(t,s){e.skillList[t].skills[s].disabled=!e.skillList[t].skills[s].disabled},e.submit=function(){console.log(e.skillList)}}]),profilesCtrl.controller("ProfilesResumeCtrl",["$scope","User","Utility","Modal",function(e){e.initialize=function(){e.tabStatus={resume:!0}}}]),profilesCtrl.controller("ProfilesCertificatesCtrl",["$scope","User","Utility","Modal",function(e){e.initialize=function(){e.tabStatus={certificates:!0}}}]);var projectsCtrl=angular.module("projectsCtrl",["ProjectServices","ModalService","DatepickerServices"]);projectsCtrl.controller("ProjectsCtrl",["$scope","Project","Utility","Modal","Datepicker",function(e,t,s,a,i){var r=t.getResource();e.projectsList=[],e.data={name:"",description:"",begin:"",end:""},e.initialize=function(){i.init(e),r.get({},function(t){t.status?e.projectsList=t.itemList:s.errorSticky("データの取得に失敗しました")})},e.create=function(){var t=new r(e.data);t.$save(function(t){t.status?(e.data={},e.projectsList.push(t.item),s.success("登録しました")):s.errorSticky(t.messages)})},e.popupView=function(t,s){e.updateid=t,e.targetindex=s,e.modalParam={header:"プロジェクトを変更します",initValue1:e.projectsList[s].name,initValue2:e.projectsList[s].description},e.modalInstance=a.open(e,"partials/modal/updateTwoItemModal.html")},e.update=function(){var t=new r({_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2});t.$save(function(t){t.status?(e.projectsList[e.targetindex]=t.item,s.success("更新しました"),e.modalInstance.close()):s.errorSticky(t.messages)})},e.delete=function(t,a){r.remove({_id:t},function(t){t.status?(e.projectsList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);var ranksCtrl=angular.module("ranksCtrl",["RankServices","ModalService"]);ranksCtrl.controller("RanksCtrl",["$scope","Rank","Utility","Modal",function(e,t,s,a){var i=t.getResource();e.ranksList=[],e.getAll=function(){i.get({},function(t){t.status?e.ranksList=t.itemList:s.errorSticky("データの取得に失敗しました")})},e.create=function(){var t=new i({name:e.rankName,description:e.description});t.$save(function(t){e.rankName="",e.description="",t.status?(e.ranksList.push(t.item),s.success("登録しました")):s.errorSticky(t.messages)})},e.popupView=function(t,s){e.updateid=t,e.targetindex=s,e.modalParam={header:"ランクを変更します",initValue1:e.ranksList[s].name,initValue2:e.ranksList[s].description},e.modalInstance=a.open(e,"partials/modal/updateTwoItemModal.html")},e.update=function(){var t=new i({_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2});t.$save(function(t){t.status?(e.ranksList[e.targetindex]=t.item,s.success("更新しました"),e.modalInstance.close()):s.errorSticky(t.messages)})},e.delete=function(t,a){i.remove({_id:t},function(t){t.status?(e.ranksList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);var skillsCtrl=angular.module("skillsCtrl",["SkillServices","ModalService"]);skillsCtrl.controller("SkillCategoryCtrl",["$rootScope","$scope","SkillCategory","Utility","Modal",function(e,t,s,a,i){t.skillCategory=s,t.categoryList=[],t.getAll=function(){t.skillCategory.get({},function(s){s.status?(t.categoryList=s.itemList,e.$broadcast("categoryListBroadcast",s.itemList)):a.errorSticky("データの取得に失敗しました")})},t.create=function(e){var i=new s({name:e});i.$save(function(e){t.categoryName="",e.status?(t.categoryList.push(e.item),a.success("登録しました")):a.errorSticky("登録に失敗しました")})},t.popupView=function(e,s){t.updateid=e,t.targetindex=s,t.modalParam={header:"カテゴリ名を変更します",initValue:t.categoryList[s].name},t.modalInstance=i.open(t,"partials/modal/updateSimpleModal.html")},t.update=function(e){var i=new s({_id:t.updateid,name:e});i.$save(function(s){s.status?(t.categoryList[t.targetindex].name=e,a.success("更新しました"),t.modalInstance.close()):a.errorSticky(s.messages)})},t.delete=function(e,s){t.skillCategory.remove({_id:e},function(e){e.status?(t.categoryList.splice(s,1),a.success("削除しました")):a.errorSticky("削除に失敗しました")})}}]),skillsCtrl.controller("SkillsCtrl",["$scope","Skill","Utility","Modal",function(e,t,s,a){e.skill=t,e.categoryList=[],e.selectCategory=null,e.$on("categoryListBroadcast",function(t,s){e.categoryList=s}),e.skillList=[],e.getSkill=function(){e.skill.get({_id:e.selectCategory},function(t){t.status?e.skillList=t.itemList:s.errorSticky("取得に失敗しました")})},e.create=function(a){var i=new t({category:e.selectCategory,name:a});i.$save(function(t){e.skillName="",t.status?e.skillList.push(t.item):s.errorSticky(t.messages)})},e.popupView=function(t,s){e.updateid=t,e.targetindex=s,e.modalParam={header:"スキル名を変更します",initValue:e.skillList[s].name},e.modalInstance=a.open(e,"partials/modal/updateSimpleModal.html")},e.update=function(a){var i=new t({_id:e.updateid,name:a});i.$save(function(t){t.status?(e.skillList[e.targetindex].name=a,s.success("更新しました"),e.modalInstance.close()):s.errorSticky(t.messages)})},e.delete=function(t,a){e.skill.remove({_id:t},function(t){t.status?(e.skillList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);var tagsCtrl=angular.module("tagsCtrl",["TagServices","ModalService"]);tagsCtrl.controller("TagsCtrl",["$scope","Tag","Utility","Modal",function(e,t,s,a){var i=t.getResource();e.tagsList=[],e.getAll=function(){i.get({},function(t){t.status?e.tagsList=t.itemList:s.errorSticky("データの取得に失敗しました")})},e.create=function(t,a){var r=new i({name:t,description:a,color:e.color});r.$save(function(t){e.postName="",e.description="",t.status?(e.tagsList.push(t.item),s.success("登録しました")):s.errorSticky(t.messages)})},e.popupView=function(t,s){e.updateid=t,e.targetindex=s,e.modalParam={header:"タグを変更します",initValue1:e.tagsList[s].name,initValue2:e.tagsList[s].description,updateColor:e.tagsList[s].color},e.modalInstance=a.open(e,"partials/modal/updateColorItemModal.html")},e.update=function(){var t={_id:e.updateid,name:e.modalParam.initValue1,description:e.modalParam.initValue2,color:e.modalParam.updateColor},a=new i(t);a.$save(function(t){e.tagName="",e.description="",t.status?(e.tagsList[e.targetindex]=t.item,s.success("更新しました"),e.modalInstance.close()):s.errorSticky(t.message)})},e.delete=function(t,a){i.remove({_id:t},function(t){t.status?(e.tagsList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);var teamsCtrl=angular.module("teamsCtrl",["TeamServices","UesrServices","ModalService"]);teamsCtrl.controller("TeamsCtrl",["$scope","$routeParams","Team","User","Utility","Modal",function(e,t,s,a,i,r){function o(t){t.status?e.userList=t.itemList:i.errorSticky(t.mesage)}function n(t){if(t.status){t.item.project={_id:t.item.project,name:l(t.item.project)};for(var s=[],a=0;a<e.selectedMemberList.length;a++)s.push({_id:e.selectedMemberList[a]._id,firstName:e.selectedMemberList[a].firstName,lastName:e.selectedMemberList[a].lastName});t.item.member=s,e.isCreate?e.teamsList.push(t.item):(e.teamsList[d]=t.item,e.isCreate=!0),e.data={},e.keywords=null,e.userList=[],e.selectedMemberList=[],i.success(t.messages)}else i.errorSticky(t.messages)}function l(t){for(var s=0;s<e.projectList.length;s++)if(t===e.projectList[s]._id)return e.projectList[s].name}var c=s.getResource(),u="",d=null;e.data={},e.isCollapsed=!1,e.isCreate=!0,e.isOpenList=!1,e.initialize=function(){e.selectedMemberList=[],c.get({},function(s){s.status?(e.teamsList=s.itemLists.teams,e.projectList=s.itemLists.projects,void 0!==t.id&&(e.data.project=t.id)):i.errorSticky(s.messages)})},e.search=function(){""===e.keywords?a.getResource().get({},o):a.getResource("keyword").get({q:e.keywords},o)},e.addMember=function(t){for(var s=e.userList[t],a={_id:s._id,firstName:s.firstName,lastName:s.lastName},i=e.selectedMemberList.length,r=!1,o=0;i>o;o++)if(e.selectedMemberList[o]._id===a._id){r=!0;break}r||e.selectedMemberList.push(a),e.selectedNumber=e.selectedMemberList.length,e.isSelected=0!==e.selectedMemberList.length},e.removeMember=function(t){e.selectedMemberList.splice(t,1);var s=e.selectedMemberList.length;e.isSelected=0!==s,e.selectedNumber=s},e.popupView=function(t,s){e.modalParam=e.userList[s],e.modalInstance=r.open(e,"partials/modal/viewUserModal.html")},e.create=function(){var t=e.data;t.member=[];for(var s=0;s<e.selectedMemberList.length;s++)t.member.push(e.selectedMemberList[s]._id);var a=new c(t);a.$save(n)},e.modeUpdate=function(t){var s=e.teamsList[t];e.data.project=s.project._id,e.data.name=s.name,e.data.description=s.description,e.isSelected=0!==s.member.length,e.selectedMemberList=s.member,e.isCreate=!1,u=e.teamsList[t]._id,d=t},e.update=function(){var t=e.data;t._id=u,t.member=[];for(var s=0;s<e.selectedMemberList.length;s++)t.member.push(e.selectedMemberList[s]._id);var a=new c(t);a.$save(n)},e.delete=function(t,s){c.remove({_id:t},function(t){t.status?(e.teamsList.splice(s,1),i.success("削除しました")):i.errorSticky(t.messages)})}}]);var usersCtrl=angular.module("usersCtrl",["UesrServices","OrganizationServices","PostTypeServices","RankServices","DatepickerServices"]);usersCtrl.controller("UsersCtrl",["$scope","$routeParams","User","Organization","PostsType","Rank","Utility","Datepicker",function(e,t,s,a,i,r,o,n){function l(t){e.data.firstName=t.firstName,e.data.lastName=t.lastName,e.data.firstNameKana=t.firstNameKana,e.data.lastNameKana=t.lastNameKana,e.data.mailAddress=t.mailAddress;var s=t.birth.split("-");e.data.birthYear=s[0],e.data.birthMonth=s[1],e.data.birthDay=s[2],e.data.sex=String(t.sex);var a=t.telNo.split("-");e.data.telFront=a[0],e.data.telCenter=a[1],e.data.telBack=a[2];var i=t.zip.split("-");e.data.zipFront=i[0],e.data.zipBack=i[1],e.data.prefectures=t.prefectures,e.data.city=t.city,e.data.address=t.address,e.data.employeeNumber=t.employeeNumber,e.data.employeeType=String(t.employeeType),e.data.organizations=t.organizations[0]._id,e.data.posts=t.posts[0]._id,e.data.ranks=t.ranks._id,e.data.entryDate=new Date(t.entryDate)}e.data={firstName:"",lastName:"",firstNameKana:"",lastNameKana:"",mailAddress:"",password:"",passwordConfirm:"",birthYear:"",birthMonth:"",birthDay:"",sex:"",telFront:"",telCenter:"",telBack:"",zipFront:"",zipBack:"",prefectures:"",city:"",address:"",employeeNumber:"",employeeType:"",organizations:"",posts:"",ranks:"",entryDate:new Date},e.initialize=function(){var c=o.subtractYear(o.today(),70).format("YYYY"),u=o.today("YYYY");e.minDate=new Date(o.subtractYear(o.today(),70).format("YYYY-MM-DD")),n.init(e),e.yearList=o.createYearList(c,u),e.monthList=o.createMonthList(),e.dayList=o.createDayList(o.dayInMonth()),e.prefecturesList=s.getPrefectures(),a.getResource().get({},function(t){t.status&&(e.organizationList=t.itemList)}),i.getResource().get({},function(t){t.status&&(e.postList=t.itemList)}),r.getResource().get({},function(t){t.status&&(e.rankList=t.itemList)}),e.isCreate=!0,void 0!==t.id&&(e.isCreate=!1,s.getResource().get({id:t.id},function(e){e.status?l(e.item):o.errorSticky(e.message)}))};var c=function(t){e.data.age=""===t?"":o.diffYear(o.today(),t)};e.createOptions=function(){var t=s.createBirth(e.data.birthYear,e.data.birthMonth,e.data.birthDay);if(""!==e.data.birthYear&&""!==e.data.birthMonth){var a=e.data.birthYear+"-"+e.data.birthMonth+"-01";e.dayList=o.createDayList(o.dayInMonth(a))}c(t)},e.getAge=function(){var t=s.createBirth(e.data.birthYear,e.data.birthMonth,e.data.birthDay);c(t)},e.submit=function(){var a="登録しました";e.isCreate||(a="更新しました",e.data.id=t.id);var i=s.getResource(),r=new i(e.data);r.$save(function(t){t.status?(e.data={},o.success(a)):o.errorSticky(t.message)})},e.remove=function(){console.log("remove")}}]);var usersListCtrl=angular.module("usersListCtrl",["UesrServices","ModalService"]);usersListCtrl.controller("UsersListCtrl",["$scope","User","Utility","Modal",function(e,t,s,a){function i(t){t.status?e.userList=t.itemList:s.errorSticky(t.mesage)}var r=t.getResource();e.sort="",e.initialize=function(){e.userList=[],e.keywords="",t.getResource().get({},i)},e.search=function(){""===e.keywords?t.getResource().get({},i):t.getResource("keyword").get({q:e.keywords},i)},e.popupView=function(t,s){e.modalParam=e.userList[s],e.modalInstance=a.open(e,"partials/modal/viewUserModal.html")},e.delete=function(t,a){r.remove({_id:t},function(t){t.status?(e.userList.splice(a,1),s.success("削除しました")):s.errorSticky("削除に失敗しました")})}}]);